{"version":3,"sources":["../out/application.js"],"names":["__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","define","require","exports","React","ReactDOM","chitu","errors_1","Object","defineProperty","Page","arguments","component","Application","args","pageCreated","add","sender","page","element","className","url","loadjs","actionExports","Errors","exportsCanntNull","action","canntFindAction","name","isReactComponent","app","props","data","source","createService","type","createElement","render","isClassComponent","prototype","isFunctionComponent","String","includes"],"mappings":"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","sourcesContent":["var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\ndefine([\"require\", \"exports\", \"react\", \"react-dom\", \"maishu-chitu\", \"./errors\"], function (require, exports, React, ReactDOM, chitu, errors_1) {\r\n    \"use strict\";\r\n    Object.defineProperty(exports, \"__esModule\", { value: true });\r\n    class Page extends chitu.Page {\r\n        constructor() {\r\n            super(...arguments);\r\n            this.component = null;\r\n        }\r\n    }\r\n    exports.Page = Page;\r\n    class Application extends chitu.Application {\r\n        constructor(args) {\r\n            super(args);\r\n            this.pageCreated.add((sender, page) => {\r\n                page.element.className = \"page\";\r\n            });\r\n        }\r\n        createDefaultAction(url, loadjs) {\r\n            return (page) => __awaiter(this, void 0, void 0, function* () {\r\n                let actionExports = yield loadjs(url);\r\n                if (!actionExports)\r\n                    throw errors_1.Errors.exportsCanntNull(url);\r\n                let action = actionExports['default'];\r\n                if (action == null) {\r\n                    throw errors_1.Errors.canntFindAction(page.name);\r\n                }\r\n                // let action: any;\r\n                // if (!chitu.PageMaster.isClass(_action)) {\r\n                //     return _action(page, this)\r\n                // }\r\n                // action = _action as any\r\n                if (isReactComponent(action)) {\r\n                    let app = this;\r\n                    let props = {\r\n                        app,\r\n                        data: page.data,\r\n                        source: page,\r\n                        createService(type) {\r\n                            return page.createService(type);\r\n                        }\r\n                    };\r\n                    let element = React.createElement(action, props);\r\n                    let component = ReactDOM.render(element, page.element);\r\n                    page.component = component;\r\n                }\r\n                else {\r\n                    new action(page);\r\n                }\r\n            });\r\n        }\r\n    }\r\n    exports.Application = Application;\r\n    function isClassComponent(component) {\r\n        return (typeof component === 'function' &&\r\n            !!component.prototype.isReactComponent) ? true : false;\r\n    }\r\n    function isFunctionComponent(component) {\r\n        return (typeof component === 'function' &&\r\n            String(component).includes('return React.createElement')) ? true : false;\r\n    }\r\n    function isReactComponent(component) {\r\n        return (isClassComponent(component) ||\r\n            isFunctionComponent(component)) ? true : false;\r\n    }\r\n});\r\n"],"file":"application.js"}