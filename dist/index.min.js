/*!
 * 
 *  maishu-chitu-react v1.40.0
 *  https://github.com/ansiboy/services-sdk
 *  
 *  Copyright (c) 2016-2018, shu mai <ansiboy@163.com>
 *  Licensed under the MIT License.
 * 
 */
!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("maishu-chitu"),require("react-dom"),require("react"));else if("function"==typeof define&&define.amd)define(["maishu-chitu","react-dom","react"],t);else{var r="object"==typeof exports?t(require("maishu-chitu"),require("react-dom"),require("react")):t(e["maishu-chitu"],e["react-dom"],e.react);for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}("undefined"==typeof window?global:window,function(e,t,r){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=6)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LOAD_PROPS=t.dataLoader=t.LOAD_DATA=void 0,t.LOAD_DATA="loadData",t.dataLoader=function(e){return function(r){return r[t.LOAD_DATA]=e,r}},t.LOAD_PROPS="loadProps"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Errors=void 0;t.Errors=class{static canntFindAction(e){let t=`Cannt find action in page '${e}', is the exports has default field?`;return new Error(t)}static exportsCanntNull(e){let t=`Exports of page '${e}' is null.`;return new Error(t)}static containerNotExist(e){let t=`Container ${e} is not exists.`;return new Error(t)}}},function(t,r){t.exports=e},function(e,r){e.exports=t},function(e,t){e.exports=r},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):function(e){return e instanceof r?e:new r(function(t){t(e)})}(e.value).then(a,s)}u((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.Application=t.Page=void 0;const o=r(4),i=r(3),a=r(2),s=r(1),u=r(0);class c extends a.Page{constructor(){super(...arguments),this.component=null}}t.Page=c;class l{constructor(e){this.nodes={},this.modulesPath=e.endsWith("/")?e.substr(0,e.length-1):e}parse(e){let t=this.nodes[e];if(null==t){let r=`${e}`.split("_").join("/");this.modulesPath&&(r=`${this.modulesPath}/${r}`),t={action:this.createDefaultAction(r,e=>this.loadjs(e)),name:e},this.nodes[e]=t}return t}createDefaultAction(e,t){return(r,a)=>n(this,void 0,void 0,function*(){let n=yield t(e);if(!n)throw s.Errors.exportsCanntNull(e);let c=n.default;if(null==c)throw s.Errors.canntFindAction(r.name);let l={app:a,data:r.data,events:{shown:r.shown,showing:r.showing,hidden:r.hidden,hiding:r.hiding},source:r,createService:e=>r.createService(e)},d=n.loadProps;if("function"==typeof d){let e=yield d(r.data,a);l=Object.assign(l,e||{})}let f=n.loadData||c[u.LOAD_DATA];if("function"==typeof f){let e=yield f(l);Object.assign(l.data,e)}let p=o.createElement(c,l),h=i.render(p,r.element);r.component=h})}}const d="targetUrl",f="index";class p extends a.Application{constructor(e){void 0===(e=e||{}).modulesPath&&(e.modulesPath="modules"),e.parser||(e.parser=p.createPageNodeParser(e.modulesPath)),super(e),e.parser.app=this,e.parser.loadjs=(e=>this.loadjs(e)),this.defaultPage=e.defaultPage||f,this.pageType=c,"history"==(e.mode||"hash")&&(this.run=(()=>{let e=this.getRouteString();this.showPage(e)}),this.parseUrl=(t=>{let r,n,o=t.indexOf("?");o>0?(r=t.substr(o),n=t.substr(0,o)):n=t;let i=null===e||void 0===e?void 0:e.routers,a={};if(null!=i)for(let e=0;e<i.length;e++){let t=i[e].match(n);if(t){let{controller:e,action:r}=t;if(!e)throw new Error("Can not get controller from route data.");if(!r)throw new Error("Can not get action from route data.");Object.assign(a,t);break}}if(r){let e=r.substr(1),t=e?this.pareeUrlQuery(e):{};Object.assign(a,t)}let s=n.split("/").filter(e=>e);return{pageName:0==s.length?"index":s.join("_"),values:a}}))}createPageElement(e,t){let r=this.containers[t];if(null==r)throw s.Errors.containerNotExist(t);let n=r.querySelector(`[name="${e}"]`);return null==n&&(n=super.createPageElement(e,t)).setAttribute("name",e),n}getRouteString(){let e=window[d];return e||(e=location.pathname||this.defaultPage,location.search&&(e+=location.search)),"/"==(e=e.trim())[0]&&(e=e.substr(1)),e}static createPageNodeParser(e){return new l(e)}}t.Application=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dataLoader=t.Page=t.Application=void 0;var n=r(5);Object.defineProperty(t,"Application",{enumerable:!0,get:function(){return n.Application}}),Object.defineProperty(t,"Page",{enumerable:!0,get:function(){return n.Page}});var o=r(0);Object.defineProperty(t,"dataLoader",{enumerable:!0,get:function(){return o.dataLoader}})}])});
//# sourceMappingURL=index.min.js.map